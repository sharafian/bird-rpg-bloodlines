!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=6)}([function(t,e){t.exports=Phaser},function(t,e,i){"use strict";var s,n=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var s=Array(t),n=0;for(e=0;e<i;e++)for(var r=arguments[e],o=0,a=r.length;o<a;o++,n++)s[n]=r[o];return s},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=o(i(0)),h=i(7),p=i(8),u=i(9),c=i(10),l=i(11),d=i(3),f=i(2);e.BIRD_SIZE=32,e.MATING_RANGE=150,e.TILE_SIZE=32;var y=function(t){function i(){var e=t.call(this,"game-scene")||this;return e.nextScene="",e.player=new p.Player(e,2e3,4e3,d.generateTraits(1)),e.miniCamera=new l.MinimapCamera(e,20,20),e.NPCs=[new h.Npc({scene:e,x:445,y:4e3,asset:"assets/birb7.png"}),new h.Npc({scene:e,x:1200,y:4e3,asset:"assets/birb7.png"})],e.items=r(Array(10)).map((function(){return new u.ItemEntity(e,d.randInt(0,l.MAP_WIDTH),4e3,f.ItemTypes[d.randInt(0,f.ItemTypes.length)])})),e.predators=[new c.GroundPredator({scene:e,x:1400,y:4e3,asset:"assets/cat2.png",size:64})],e.components=[e.miniCamera],e.entities=r(e.NPCs,e.predators,e.items,[e.player]),e.scheduledFadeout=!1,e}return n(i,t),i.prototype.preload=function(){this.load.tilemapCSV("environment_map","assets/map3.csv"),this.load.image("environment_tiles_extruded","assets/environment_extruded.png"),this.entities.forEach((function(t){return t.preload()})),this.components.forEach((function(t){return t.preload()})),this.load.audio("theme",["assets/audio/bird_trap.mp3"])},i.prototype.onFade=function(t,e){1===e&&this.scene.start(this.nextScene,this.nextSceneData)},i.prototype.create=function(){var t=this;this.entities.forEach((function(t){return t.create()})),this.components.forEach((function(t){return t.create()})),this.createEnvironment();var i=this.sound.add("theme");i.play(),this.events.on("shutdown",(function(){i.stop()}));var s=this.physics.add.group();this.predators.forEach((function(t){return t.addToGroup(s)})),this.physics.add.collider(this.player.getSprite(),s,(function(){t.player.dead||(t.player.die(),setTimeout((function(){t.scheduleFadeout("game-over")}),1e3))})),this.player.on("start_singing",(function(e,i){var s=t.closestEntity("npc").entity;s&&s.desiresFulfilled(e,i)&&(t.player.startLovin(),s.startLovin(),setTimeout((function(){t.scheduleFadeout("mating-scene",{playerTraits:e,mateTraits:s.traits})}),1e3))})),this.player.on("pickup",(function(){var e=t.closestEntity("item"),i=e.entity,s=void 0===i?void 0:i,n=e.index,r=void 0===n?0:n;if(s){s.getSprite().setVisible(!1),t.player.addItem(s.itemType),t.items=t.items.filter((function(t,e){return e!==r}));var o=0,a=void 0;for(var h in t.entities)if("item"===t.entities[h].type&&o++,o>=r+1){a=parseInt(h,10);break}a&&t.entities.splice(a,1)}})),this.player.on("drop",(function(i){var s=new u.ItemEntity(t,t.player.getPosition().x,t.player.getPosition().y-e.BIRD_SIZE,i);t.items.push(s),s.create()}));var n=this.player.getTraits()||{speed:5,beauty:5};this.traitsDisplay=this.add.text(400,440,"Speed: "+n.speed+"   Beauty: "+n.beauty,{fill:"#000"}),this.traitsDisplay.setScrollFactor(0)},i.prototype.updateTraitsUI=function(){if(this.traitsDisplay){var t=this.player.getTraits();this.traitsDisplay.text="Speed: "+(null==t?void 0:t.speed)+"   Beauty: "+(null==t?void 0:t.beauty),this.traitsDisplay.updateText()}},i.prototype.createEnvironment=function(){var t=this;this.map=this.make.tilemap({key:"environment_map",tileWidth:e.TILE_SIZE,tileHeight:e.TILE_SIZE});var i=this.map.addTilesetImage("environment_tiles","environment_tiles_extruded",32,32,1,2),s=this.map.createStaticLayer(0,i,0,0),n=[2,8,14,21,28,16,22,24,44,48];s.setCollision(n),s.layer.data.forEach((function(t){t.forEach((function(t){n.includes(t.index)&&(t.collideDown=!1,t.collideLeft=!1,t.collideRight=!1,t.collideUp=!0)}))})),this.entities.forEach((function(e){t.physics.add.collider(e.getSprite(),s)})),this.cameras.main.startFollow(this.player.getSprite(),!0,.1,.1),this.cameras.main.setBounds(0,0,this.map.widthInPixels,this.map.heightInPixels),this.cameras.main.setBackgroundColor("#a6dbed")},i.prototype.scheduleFadeout=function(t,e){this.nextScene=t,this.nextSceneData=e,this.scheduledFadeout=!0},i.prototype.update=function(t,e){this.scheduledFadeout&&this.map&&(this.scheduledFadeout=!1,this.cameras.main._cw=this.map.widthInPixels,this.cameras.main._ch=this.map.heightInPixels,this.cameras.main.fadeOut(1e3,0,0,0,this.onFade.bind(this)));var i=this.closestEntity("npc").entity;i&&i.setShowOutline(),this.entities.forEach((function(i){return i.update(t,e)})),this.components.forEach((function(i){return i.update(t,e)}))},i.prototype.closestEntity=function(t){var i=this;if(!this.player)throw new Error("player does not exist");var s=this.entities.filter((function(e){return!t||e.type===t})),n=s.reduce((function(t,e,s){var n=t.entity,r=t.index;if(!i.player)throw new Error("player does not exist");var o=a.default.Math.Distance.BetweenPoints(i.player.getSprite(),n.getSprite());return a.default.Math.Distance.BetweenPoints(i.player.getSprite(),e.getSprite())<o?{entity:e,index:s}:{entity:n,index:r}}),{entity:s[0],index:0});return a.default.Math.Distance.BetweenPoints(this.player.getSprite(),n.entity.getSprite())>e.MATING_RANGE?{entity:null,index:null}:n},i.prototype.getPlayer=function(){return this.player},i}(a.default.Scene);e.GameScene=y},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ItemTypes=[{name:"rock",asset:"assets/items/rock.png"},{name:"stick",asset:"assets/items/stick.png"},{name:"berry",asset:"assets/items/berry.png"},{name:"worm",asset:"assets/items/worm.png"}],e.ITEM_WEIGHT=10},function(t,e,i){"use strict";var s=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var s=Array(t),n=0;for(e=0;e<i;e++)for(var r=arguments[e],o=0,a=r.length;o<a;o++,n++)s[n]=r[o];return s};Object.defineProperty(e,"__esModule",{value:!0});var n=i(4),r=i(2),o=n.MAX_VALUE/8;function a(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t))+t}e.randInt=a,e.generateDesires=function(t){var e=Math.floor(n.MAX_VALUE/r.ITEM_WEIGHT),i=a(-1*o,o+1),h=(t.beauty+i)/n.MAX_VALUE,p=Math.max(Math.floor(e*h),0),u=s(Array(p)).map((function(){return r.ItemTypes[a(0,r.ItemTypes.length)]})),c=a(-1*o,o+1);return{items:u,minBeauty:Math.max(t.speed+c,0)}},e.generateTraits=function(t){return{speed:a(o*t,o*(t+1)),beauty:a(o*t,o*(t+1))}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MAX_VALUE=100},function(t,e,i){"use strict";var s,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)};s=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var o=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var h=10;function p(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function u(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function c(t,e,i,s){var n,r,o,a;if(p(i),void 0===(r=t._events)?(r=t._events=Object.create(null),t._eventsCount=0):(void 0!==r.newListener&&(t.emit("newListener",e,i.listener?i.listener:i),r=t._events),o=r[e]),void 0===o)o=r[e]=i,++t._eventsCount;else if("function"==typeof o?o=r[e]=s?[i,o]:[o,i]:s?o.unshift(i):o.push(i),(n=u(t))>0&&o.length>n&&!o.warned){o.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=t,h.type=e,h.count=o.length,a=h,console&&console.warn&&console.warn(a)}return t}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(t,e,i){var s={fired:!1,wrapFn:void 0,target:t,type:e,listener:i},n=l.bind(s);return n.listener=i,s.wrapFn=n,n}function f(t,e,i){var s=t._events;if(void 0===s)return[];var n=s[e];return void 0===n?[]:"function"==typeof n?i?[n.listener||n]:[n]:i?function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(n):m(n,n.length)}function y(t){var e=this._events;if(void 0!==e){var i=e[t];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function m(t,e){for(var i=new Array(e),s=0;s<e;++s)i[s]=t[s];return i}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return h},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");h=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var s="error"===t,n=this._events;if(void 0!==n)s=s&&void 0===n.error;else if(!s)return!1;if(s){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var h=n[t];if(void 0===h)return!1;if("function"==typeof h)r(h,this,e);else{var p=h.length,u=m(h,p);for(i=0;i<p;++i)r(u[i],this,e)}return!0},a.prototype.addListener=function(t,e){return c(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return c(this,t,e,!0)},a.prototype.once=function(t,e){return p(e),this.on(t,d(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return p(e),this.prependListener(t,d(this,t,e)),this},a.prototype.removeListener=function(t,e){var i,s,n,r,o;if(p(e),void 0===(s=this._events))return this;if(void 0===(i=s[t]))return this;if(i===e||i.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete s[t],s.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!=typeof i){for(n=-1,r=i.length-1;r>=0;r--)if(i[r]===e||i[r].listener===e){o=i[r].listener,n=r;break}if(n<0)return this;0===n?i.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(i,n),1===i.length&&(s[t]=i[0]),void 0!==s.removeListener&&this.emit("removeListener",t,o||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,i,s;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[t]),this;if(0===arguments.length){var n,r=Object.keys(i);for(s=0;s<r.length;++s)"removeListener"!==(n=r[s])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=i[t]))this.removeListener(t,e);else if(void 0!==e)for(s=e.length-1;s>=0;s--)this.removeListener(t,e[s]);return this},a.prototype.listeners=function(t){return f(this,t,!0)},a.prototype.rawListeners=function(t){return f(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):y.call(t,e)},a.prototype.listenerCount=y,a.prototype.eventNames=function(){return this._eventsCount>0?s(this._events):[]}},function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var n=s(i(0)),r=i(1),o=i(12),a=i(13),h=i(14),p=i(17),u={type:n.default.AUTO,pixelArt:!0,scale:{mode:n.default.Scale.NONE,autoCenter:n.default.Scale.CENTER_BOTH,width:640,height:480,zoom:1,max:{width:640,height:480}},physics:{default:"arcade",arcade:{gravity:{y:500},debug:!1}},scene:[a.MainMenu,r.GameScene,o.AboutMenu,h.MateScene,p.GameOver]},c=new n.default.Game(u);e.default=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i(1),n=i(3),r=function(){function t(t){var e=t.scene,i=t.x,s=t.y,r=t.asset,o=t.generationNum,a=void 0===o?0:o;this.type="npc",this.facing=-1,this.lovin=!1,this.showOutline=!1,this.scene=e,this.x=i,this.y=s,this.asset=r,this.traits=n.generateTraits(a),this.desires=n.generateDesires(this.traits)}return t.prototype.preload=function(){this.scene.load.image("heart","assets/particles/heart.png"),this.scene.load.image("card","assets/twinderframe.png"),this.scene.load.spritesheet(this.asset+"-npc",this.asset,{frameWidth:s.BIRD_SIZE,frameHeight:s.BIRD_SIZE})},t.prototype.create=function(){this.facing=-1,this.lovin=!1,this.sprite=this.scene.physics.add.sprite(this.x,this.y,this.asset+"-npc"),this.sprite.setOrigin(.5),this.sprite.setDepth(75),this.card=this.scene.add.sprite(0,0,"card"),this.card.setPosition(625-this.card.width/2,15+this.card.height/2),this.card.setDepth(150),this.card.setVisible(!1),this.card.setScrollFactor(0);var t=this.card.getTopLeft(void 0,!0);console.log("cardTextCoords",t),this.cardText=this.scene.add.text(t.x,t.y,this.cardTextContent(),{color:"black",fontSize:"9px",padding:{top:10,left:5}}),this.cardText.setDepth(151),this.cardText.setScrollFactor(0),this.scene.anims.create({key:this.asset+"-stand",frameRate:0,frames:this.scene.anims.generateFrameNumbers(this.asset+"-npc",{start:3,end:3})}),this.scene.anims.create({key:this.asset+"-outline",frameRate:0,frames:this.scene.anims.generateFrameNumbers(this.asset+"-npc",{start:8,end:8})}),this.sprite.anims.play(this.asset+"-stand"),this.sprite.setDebug(!0,!0,65280);var e=this.scene.add.particles("heart");e.setDepth(76),this.heartEmitter=e.createEmitter({lifespan:1e3,speed:{min:25,max:50},angle:{min:250,max:290},radial:!0,gravityY:-50,frequency:250,quantity:1})},t.prototype.startLovin=function(){this.lovin=!0,this.heartEmitter&&this.sprite?(this.heartEmitter.start(),this.heartEmitter.setPosition(this.sprite.x+s.BIRD_SIZE+(this.facing>0?s.BIRD_SIZE/2:0),this.sprite.y+s.BIRD_SIZE/2)):console.log("no emitter")},t.prototype.stopLovin=function(){var t;this.lovin=!1,null===(t=this.heartEmitter)||void 0===t||t.stop()},t.prototype.setShowOutline=function(){this.showOutline=!0},t.prototype.cardTextContent=function(){return"\n\nBeauty: "+this.traits.beauty+"\n\nSpeed: "+this.traits.speed+"\n\n\n\nWants...\n\nBeauty: >="+this.desires.minBeauty+"\n\nItems: "+(this.desires.items[0]?this.desires.items.reduce((function(t,e){return t+e.name+" "}),""):"none")},t.prototype.update=function(){if(this.sprite&&this.card&&this.cardText)if(this.showOutline?(this.showOutline=!1,this.card.setVisible(!0),this.cardText.setVisible(!0),this.sprite.anims.play(this.asset+"-outline")):(this.card.setVisible(!1),this.cardText.setVisible(!1),this.sprite.anims.play(this.asset+"-stand")),this.lovin)this.sprite.setVelocityX(0);else{var t=Math.random();t>0&&t<=.02?this.facing=this.facing<0?1:-1:t>.05&&t<=.2?this.sprite.setVelocityX(2*this.facing*s.BIRD_SIZE):this.sprite.setVelocityX(0),this.sprite.setFlipX(this.facing>0)}},t.prototype.getPosition=function(){if(!this.sprite)throw new Error("sprite does not exist");return{x:this.sprite.x,y:this.sprite.y}},t.prototype.getSprite=function(){if(!this.sprite)throw new Error("sprite does not exist");return this.sprite},t.prototype.desiresFulfilled=function(t,e){t.beauty,this.desires.minBeauty;for(var i=e.map((function(t){return t.name})),s=0,n=this.desires.items.map((function(t){return t.name}));s<n.length;s++){var r=n[s],o=i.indexOf(r);if(-1===o)return!1;i.splice(o,1)}return!0},t.prototype.die=function(){console.log("npc died")},t}();e.Npc=r},function(t,e,i){"use strict";var s,n=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),o=i(5),a=i(2),h=function(t){function e(e,i,s,n){var r=t.call(this)||this;return r.scene=e,r.x=i,r.y=s,r.traits=n,r.type="player",r.flapping=!1,r.singing=!1,r.lovin=!1,r.dead=!1,r.facing=1,r.inventory=[],r}return n(e,t),e.prototype.preload=function(){this.scene.load.spritesheet("blood","assets/particles/blood.png",{frameWidth:12,frameHeight:12}),this.scene.load.spritesheet("notes","assets/particles/notes.png",{frameWidth:12,frameHeight:12}),this.scene.load.spritesheet("birb","assets/birb5.png",{frameWidth:r.BIRD_SIZE,frameHeight:r.BIRD_SIZE})},e.prototype.create=function(){var t=this;this.flapping=!1,this.singing=!1,this.lovin=!1,this.facing=1,this.dead=!1;var e=this.scene.add.particles("notes");e.setDepth(100);var i=e.createEmitter({frame:[0,1,2,3,4,5,6,7],x:40,y:0,lifespan:800,speed:{min:100,max:200},angle:{min:300,max:360},radial:!0,gravityY:0,quantity:2,frequency:150}),s=this.scene.add.particles("blood");s.setDepth(100),this.bloodEmitter=s.createEmitter({frame:[5],x:0,y:0,lifespan:1e3,rotate:{min:0,max:360},speed:{min:100,max:200},angle:{min:0,max:360},gravityY:500,quantity:5,frequency:100}),this.bloodEmitter.stop(),i.stop(),this.sprite=this.scene.physics.add.sprite(this.x,this.y,"birb"),this.sprite.setDepth(100),this.sprite.setMaxVelocity(1e3,250),this.scene.anims.create({key:"stand",frameRate:0,frames:this.scene.anims.generateFrameNumbers("birb",{start:3,end:2})}),this.scene.anims.create({key:"walk",frameRate:10,repeat:-1,frames:this.scene.anims.generateFrameNumbers("birb",{start:3,end:5})}),this.scene.anims.create({key:"fly",frameRate:10,frames:this.scene.anims.generateFrameNumbers("birb",{start:0,end:2})}),this.scene.anims.create({key:"pickup",frameRate:10,frames:this.scene.anims.generateFrameNumbers("birb",{frames:[5,6,7,6,5]})}),this.cursors=this.scene.input.keyboard.createCursorKeys();var n=this.scene.input.keyboard.addKey("Z"),r=this.scene.input.keyboard.addKey("X");r.on("down",(function(){var e,i,s,n=null===(e=t.sprite)||void 0===e?void 0:e.body.blocked.down,r="pickup"===(null===(i=t.sprite)||void 0===i?void 0:i.anims.getCurrentKey()),o=null===(s=t.sprite)||void 0===s?void 0:s.anims.isPlaying;t.dead||!n||r&&o||(t.emit("pickup"),t.sprite.anims.play("pickup"))})),n.on("down",(function(){var e,s;if(!t.lovin){var n=null===(e=t.sprite)||void 0===e?void 0:e.body.velocity.y,r=null===(s=t.sprite)||void 0===s?void 0:s.body.velocity.x,o=0===n&&0===r;!t.dead&&t.sprite&&o&&(t.singing=!0,i.setEmitterAngle({min:t.facing<0?180:300,max:t.facing<0?240:360}),i.setPosition(t.sprite.x+20*t.facing,t.sprite.y-10),t.emit("start_singing",t.traits,t.inventory),i.start())}})),n.on("up",(function(){t.lovin||(t.emit("stop_singing"),t.singing=!1,i.stop())})),this.scene.events.on("shutdown",(function(){var e,i,s,o,a,h,p,u;n.removeAllListeners(),r.removeAllListeners(),null===(i=null===(e=t.cursors)||void 0===e?void 0:e.up)||void 0===i||i.removeAllListeners(),null===(o=null===(s=t.cursors)||void 0===s?void 0:s.down)||void 0===o||o.removeAllListeners(),null===(h=null===(a=t.cursors)||void 0===a?void 0:a.left)||void 0===h||h.removeAllListeners(),null===(u=null===(p=t.cursors)||void 0===p?void 0:p.right)||void 0===u||u.removeAllListeners()}))},e.prototype.startLovin=function(){this.lovin=!0},e.prototype.stopLovin=function(){this.lovin=!1},e.prototype.deathAnimation=function(){if(this.sprite&&this.bloodEmitter){var t=this.sprite.getCenter(),e=t.x,i=t.y;this.bloodEmitter.explode(20,e,i),this.sprite.setVisible(!1)}},e.prototype.update=function(){var t,e,i,s;if(this.cursors&&this.sprite)if(this.singing||this.dead)this.sprite.setVelocityX(0);else{(null===(t=this.cursors.up)||void 0===t?void 0:t.isDown)?(this.flapping||(this.sprite.anims.isPlaying||this.sprite.anims.play("fly"),this.sprite.setVelocityY(-7*r.BIRD_SIZE)),this.flapping=!0):this.flapping=!1,(null===(e=this.cursors.left)||void 0===e?void 0:e.isDown)?(this.facing=-1,this.sprite.setVelocityX(-2*r.BIRD_SIZE)):(null===(i=this.cursors.right)||void 0===i?void 0:i.isDown)?(this.facing=1,this.sprite.setVelocityX(2*r.BIRD_SIZE)):this.sprite.setVelocityX(0),this.isFlying()&&this.sprite.setVelocityX(6*this.facing*r.BIRD_SIZE),this.sprite.setFlipX(this.facing>0);var n=this.getAnim();(null===(s=this.sprite.anims.currentAnim)||void 0===s?void 0:s.key)!==n&&this.sprite.anims.play(n)}},e.prototype.isFlying=function(){if(!this.sprite)throw new Error("no player");return!!this.sprite.body.velocity.y},e.prototype.getAnim=function(){return this.sprite?"pickup"!==this.sprite.anims.getCurrentKey()||this.sprite.anims.isPaused?this.isFlying()?"fly":this.sprite.body.velocity.x?"walk":"stand":"pickup":"stand"},e.prototype.getPosition=function(){if(!this.sprite)throw new Error("no player");return this.sprite},e.prototype.die=function(){this.dead||this.deathAnimation(),this.dead=!0},e.prototype.addItem=function(t){this.inventory.length>=Math.floor(this.traits.speed/a.ITEM_WEIGHT)&&this.emit("drop",this.inventory.shift()),this.inventory.push(t)},e.prototype.getSprite=function(){if(this.sprite)return this.sprite;throw new Error("Player object has no sprite.")},e.prototype.getTraits=function(){if(this.traits)return this.traits},e}(o.EventEmitter);e.Player=h},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e,i,s){this.scene=t,this.x=e,this.y=i,this.itemType=s,this.type="item"}return t.prototype.preload=function(){this.scene.load.spritesheet(this.itemType.name,this.itemType.asset,{frameWidth:32,frameHeight:32})},t.prototype.create=function(){this.sprite=this.scene.physics.add.sprite(this.x,this.y,this.itemType.name),this.sprite.setOrigin(.5),this.sprite.setDepth(75)},t.prototype.update=function(){},t.prototype.getSprite=function(){if(this.sprite)return this.sprite;throw new Error("Item entity has no sprite.")},t}();e.ItemEntity=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t){var e=t.scene,i=t.x,s=t.y,n=t.asset,r=t.size;this.type="ground-predator",this.facing=-1,this.timeCounter=0,this.scene=e,this.x=i,this.y=s,this.asset=n,this.size=r}return t.prototype.preload=function(){this.scene.load.spritesheet(this.asset+"-ground-predator",this.asset,{frameWidth:this.size,frameHeight:this.size})},t.prototype.create=function(){this.sprite=this.scene.physics.add.sprite(this.x,this.y,this.asset+"-ground-predator"),this.sprite.setDepth(50),this.scene.anims.create({key:this.asset+"-stand",frameRate:0,frames:this.scene.anims.generateFrameNumbers(this.asset+"-ground-predator",{start:3,end:3})}),this.scene.anims.create({key:this.asset+"-walk",frameRate:2,repeat:-1,frames:this.scene.anims.generateFrameNumbers(this.asset+"-ground-predator",{start:0,end:3})}),this.scene.anims.create({key:this.asset+"-run",frameRate:10,repeat:-1,frames:this.scene.anims.generateFrameNumbers(this.asset+"-ground-predator",{start:0,end:3})}),this.scene.anims.create({key:this.asset+"-jump",frameRate:0,frames:this.scene.anims.generateFrameNumbers(this.asset+"-ground-predator",{start:1,end:2})}),this.sprite.anims.play(this.asset+"-stand"),this.sprite.setDebug(!0,!0,65280)},t.prototype.update=function(t,e){var i=this.scene.getPlayer();this.timeCounter+=e,this.timeCounter>200&&(this.timeCounter=0,this.isFarther(i,250)?this.prowl():this.attack(i));var s=this.getAnim();s!==this.sprite.anims.getCurrentKey()&&this.sprite.anims.play(s),this.sprite.setFlipX(this.facing<0)},t.prototype.isFarther=function(t,e){var i=this.getPosition(),s=t.getPosition();return Phaser.Math.Distance.BetweenPoints(i,s)>e},t.prototype.prowl=function(){var t=Math.random();t>0&&t<=.02?this.facing=this.facing<0?1:-1:this.sprite.setVelocityX(.25*this.facing*this.size)},t.prototype.runLeft=function(){this.sprite.setVelocityX(-240),this.facing=-1},t.prototype.runRight=function(){this.sprite.setVelocityX(240),this.facing=1},t.prototype.jump=function(){this.sprite.setVelocityY(-400)},t.prototype.stop=function(){this.sprite.setVelocity(0)},t.prototype.attack=function(t){var e=t.getPosition(),i=this.getPosition(),s=this.sprite.body.blocked.down;Math.abs(e.x-i.x)<100&&i.y>e.y+100&&s?this.jump():e.x>i.x&&s?this.runRight():e.x<i.x&&s&&this.runLeft()},t.prototype.kill=function(t){t.die()},t.prototype.getPosition=function(){if(!this.sprite)throw new Error("sprite does not exist");return{x:this.sprite.x,y:this.sprite.y}},t.prototype.getSprite=function(){if(!this.sprite)throw new Error("sprite does not exist");return this.sprite},t.prototype.getAnim=function(){var t=this.sprite.body.blocked.down,e=Math.abs(this.sprite.body.velocity.x);return t?240===e?this.asset+"-run":e?this.asset+"-walk":this.asset+"-stand":this.asset+"-jump"},t.prototype.addToGroup=function(t){if(!this.sprite)throw new Error("no sprite");t.add(this.sprite)},t}();e.GroundPredator=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.MAP_WIDTH=9600,e.MAP_HEIGHT=5120;var s=function(){function t(t,e,i){this.scene=t,this.x=e,this.y=i}return t.prototype.preload=function(){},t.prototype.create=function(){var t=this.scene.add.rectangle(this.x+75,this.y+40,152,82,0,1);t.setDepth(151),t.setScrollFactor(0),this.camera=this.scene.cameras.add(this.x,this.y,150,80),this.camera.setBounds(0,0,e.MAP_WIDTH,e.MAP_HEIGHT),this.camera.setZoom(150/e.MAP_WIDTH),this.camera.setName("mini"),this.camera.setBackgroundColor("#a6dbed"),this.scene.add.rectangle(-5,-5,10,10,16711680),this.blip=this.scene.cameras.add(0,0,4,4),this.blip.setBounds(-10,-10,10,10)},t.prototype.update=function(){if(this.blip){var t=this.scene.getPlayer().getSprite(),i=t.x,s=t.y;this.blip.setPosition(this.x-2+Math.floor(i/e.MAP_WIDTH*150),this.y-2+Math.floor(s/e.MAP_HEIGHT*80))}},t}();e.MinimapCamera=s},function(t,e,i){"use strict";var s,n=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(i(0)),a=function(t){function e(){var e=t.call(this,"about-menu")||this;return e.menuY=80,e}return n(e,t),e.prototype.preload=function(){this.load.image("titlenotext","assets/titlenotext.png")},e.prototype.create=function(){var t=this;this.add.image(400,250,"titlenotext");this.add.text(60,this.menuY-40,"How to play",{color:"black",fontSize:"36px"}),this.add.text(60,this.menuY,"\nYou are a horny finch.\n\nUse the ARROW KEYS to fly around\n\nPress Z to woo your lady\n\nHit ENTER to return to the \nmain menu\n\nFind mates to have better \nstats in each generation\n\nKeep your bloodline alive \nas long as possible!\n",{color:"black",fontSize:"20px"});var e=this.input.keyboard.addKey("ENTER");e.on("up",(function(){t.scene.start("main-menu")})),this.events.on("shutdown",(function(){e.removeAllListeners()}))},e}(o.default.Scene);e.AboutMenu=a},function(t,e,i){"use strict";var s,n=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this,"main-menu")||this;return e.selection=0,e.menuY=380,e.menuRowHeight=30,e.menuItems=[{title:"Start",scene:"game-scene"},{title:"Controls",scene:"about-menu"}],e}return n(e,t),e.prototype.preload=function(){this.load.image("title","assets/title.png"),this.load.audio("menu",["assets/audio/bird_rave.mp3"])},e.prototype.create=function(){var t,e,i=this,s={color:"white",fontSize:"24px"},n=this.sound.add("menu");n.play(),this.events.on("shutdown",(function(){n.stop()})),this.add.image(400,250,"title");for(var r=0;r<this.menuItems.length;++r){var o=this.menuItems[r];this.add.text(100,this.menuY+r*this.menuRowHeight,o.title,s)}var a=this.input.keyboard.createCursorKeys(),h=this.add.rectangle(250,this.menuY+this.selection*this.menuRowHeight+15,300,27,16777215,.5),p=function(){h.setY(i.menuY+i.selection*i.menuRowHeight+15)};null===(t=a.up)||void 0===t||t.on("down",(function(){i.selection=Math.max(i.selection-1,0),p()})),null===(e=a.down)||void 0===e||e.on("down",(function(){i.selection=Math.min(i.selection+1,1),p()}));var u=this.input.keyboard.addKey("ENTER");u.on("up",(function(){i.scene.start(i.menuItems[i.selection].scene)})),this.events.on("shutdown",(function(){var t,e,i,s;u.removeAllListeners(),null===(t=a.up)||void 0===t||t.removeAllListeners(),null===(e=a.down)||void 0===e||e.removeAllListeners(),null===(i=a.left)||void 0===i||i.removeAllListeners(),null===(s=a.right)||void 0===s||s.removeAllListeners()}))},e}(r(i(0)).default.Scene);e.MainMenu=o},function(t,e,i){"use strict";var s,n=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var s=Array(t),n=0;for(e=0;e<i;e++)for(var r=arguments[e],o=0,a=r.length;o<a;o++,n++)s[n]=r[o];return s},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=o(i(0)),h=i(15),p=i(16),u=i(4),c=function(t){function e(){var e=t.call(this,"mating-scene")||this;return e.egg=new p.Egg(e,320,130),e}return n(e,t),e.prototype.init=function(t){var e=t.playerTraits,i=t.mateTraits;if(!e)throw new Error("playerTraits was not passed to mate scene!");if(this.playerTraits=e,!i)throw new Error("mateTraits was not passed to mate scene!");this.mateTraits=i;var s=[this.playerTraits.beauty/u.MAX_VALUE,this.mateTraits.beauty/u.MAX_VALUE],n=[this.playerTraits.speed/u.MAX_VALUE,this.mateTraits.speed/u.MAX_VALUE];this.sliders=[new h.RouletteSlider(this,320,220,Math.min.apply(Math,s),Math.max.apply(Math,s)),new h.RouletteSlider(this,320,250,Math.min.apply(Math,n),Math.max.apply(Math,n))],this.components=r(this.sliders,[this.egg])},e.prototype.preload=function(){var t;null===(t=this.components)||void 0===t||t.forEach((function(t){return t.preload()}))},e.prototype.onFade=function(t,e){1===e&&this.scene.start("game-scene")},e.prototype.create=function(){var t,e=this;null===(t=this.components)||void 0===t||t.forEach((function(t){return t.create()}));var i=this.add.text(175,300,"Hit ENTER to select attributes",{color:"white"}),s=this.input.keyboard.addKey("ENTER");s.once("up",(function(){var t;null===(t=e.sliders)||void 0===t||t.forEach((function(t){return t.stop()})),i.setText(""),e.egg.hatch(),e.egg.once("hatched",(function(){e.cameras.main.fadeOut(2e3,0,0,0,e.onFade.bind(e))}))})),this.events.on("shutdown",(function(){s.removeAllListeners()}))},e.prototype.update=function(t,e){var i;null===(i=this.components)||void 0===i||i.forEach((function(i){return i.update(t,e)}))},e}(a.default.Scene);e.MateScene=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e,i,s,n){this.scene=t,this.x=e,this.y=i,this.lowerBound=s,this.upperBound=n,this.width=300,this.height=25,this.speed=200,this.stopped=!1}return t.prototype.preload=function(){},t.prototype.positionToX=function(t){return this.x-this.width/2+this.width*t},t.prototype.addMark=function(t,e){return this.scene.add.rectangle(this.positionToX(t),this.y,6,this.height,e)},t.prototype.getBody=function(){if(!this.selectangle)throw new Error("no selection");return this.selectangle.body},t.prototype.create=function(){this.stopped=!1,this.scene.add.rectangle(this.x,this.y,this.width,this.height,16777215);var t=this.lowerBound+Math.random()*(this.upperBound-this.lowerBound),e=this.addMark(t,65280);this.selectangle=this.scene.physics.add.existing(e,!1),this.getBody().setAllowGravity(!1),this.getBody().setVelocityX(Math.random()<.5?-this.speed:this.speed),this.addMark(this.lowerBound,267666500),this.addMark(this.upperBound,71582975)},t.prototype.update=function(){this.selectangle&&(this.stopped?this.getBody().setVelocityX(0):this.getBody().x<=this.positionToX(this.lowerBound)?this.getBody().setVelocityX(this.speed):this.getBody().x>=this.positionToX(this.upperBound)&&this.getBody().setVelocityX(-this.speed))},t.prototype.getPosition=function(){return{x:this.x,y:this.y}},t.prototype.stop=function(){this.stopped=!0},t}();e.RouletteSlider=s},function(t,e,i){"use strict";var s,n=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){function e(e,i,s){var n=t.call(this)||this;return n.scene=e,n.x=i,n.y=s,n}return n(e,t),e.prototype.preload=function(){this.scene.load.spritesheet("hatch","assets/hatch.png",{frameWidth:16,frameHeight:16})},e.prototype.create=function(){this.scene.anims.create({key:"hatch",frameRate:10,frames:this.scene.anims.generateFrameNumbers("hatch",{start:0,end:16})}),this.sprite=this.scene.add.sprite(this.x,this.y,"hatch"),this.sprite.setScale(4,4)},e.prototype.update=function(){},e.prototype.hatch=function(){var t,e,i=this;null===(t=this.sprite)||void 0===t||t.anims.play("hatch"),null===(e=this.sprite)||void 0===e||e.on("animationcomplete",(function(){i.emit("hatched")}))},e.prototype.getPosition=function(){if(!this.sprite)throw new Error("no sprite");return this.sprite},e}(i(5).EventEmitter);e.Egg=r},function(t,e,i){"use strict";var s,n=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return t.call(this,"game-over")||this}return n(e,t),e.prototype.preload=function(){this.load.image("game-over","assets/gameover.png"),this.load.audio("loss",["assets/audio/bird_loss.mp3"])},e.prototype.create=function(){var t=this,e=this.sound.add("loss");e.play(),this.events.on("shutdown",(function(){e.stop()})),this.add.image(320,240,"game-over");this.add.text(250,400,"Press ENTER",{color:"white",fontSize:"20px",align:"center"});var i=this.input.keyboard.addKey("ENTER");i.on("up",(function(){t.scene.start("main-menu")})),this.events.on("shutdown",(function(){i.removeAllListeners()}))},e}(r(i(0)).default.Scene);e.GameOver=o}]);
//# sourceMappingURL=main.js.map